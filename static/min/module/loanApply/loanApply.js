require.config({map:{"*":{css:"./core/css.min"}},baseUrl:basePath,paths:{base:"core/base",dialog:"widget/dialog/dialog",all:"public/all",validate:"public/validate",area:"widget/complexArea/complexArea",doc:"public/zhdoc"}}),define(["base","dialog","doc","area","validate","all","css!module/loanApply/loanApply"],function(e,t,n,r,i){function b(){return i(f,v)&&i(l,m)&&i(c,g)&&i(h,y)}function w(){var e="13131313";$.ajax({url:"/fetchParter",type:"post",data:e,dataType:"json",success:function(e){e.code==0&&E(e.data)}})}function E(e){var t=[];$.each(e,function(e,n){t.push(new Option(n.text,n.id))}),parter.append(t)}function x(e){$(".errorTip").html(e)}function T(){$(".errorTip").html("")}function N(){$(".dialogParter").hide(),$(".dialogParter_mask").hide(),$("#parterType").val(""),$("#company").val(""),$(".errorTip").html("")}function C(){$(".dialogParter").show(),$(".dialogParter_mask").show()}function A(e){return e.trim()?(T(),!0):(x("请选择品类"),!1)}function O(e){return e.trim()?(T(),!0):(x("请输入厂商"),!1)}function M(e){var t=[]}var s=new t.Dialog,o=$("#loadApplyForm"),u=$("#provinceCode"),a=$("#cityCode"),f=$("#projectName"),l=$("#propertyDeveloper"),c=$("#contractAmount"),h=$("#loanAmount"),p=$("#loanLimit"),d=$("#partner"),v=[{noBlank:"请输入项目名称",typeZh:"请输入中文",min:[4,"不能少于4位"],max:[15,"不能多于15位"]},function(e){$(".projectNamePrompt").html(e)}],m=[{noBlank:"请输入开发商名称",typeZh:"请输入中文",min:[4,"不能少于4位"],max:[15,"不能多于15位"]},function(e){$(".propertyDeveloperPrompt").html(e)}],g=[{noBlank:"请输入合同金额",typeNum:"请输入数字",min:[1,"不能少于1位"],max:[5,"不能多于5位"]},function(e){$(".contractAmountPrompt").html(e)}],y=[{noBlank:"请输入贷款金额",typeNum:"请输入数字",min:[1,"不能少于1位"],max:[5,"不能多于5位"],self:function(e){return this.value.trim()>c.val()/10?e("贷款不能超过合同金额10%"):!0}},function(e){$(".loanAmountPrompt").html(e)}];i(f,["change"],v),i(l,["change"],m),i(c,["change"],g),i(h,["change"],y),o.on("submit",function(){var e=u.val(),t=a.val(),r=f.val(),i=l.val(),o=c.val(),v=h.val(),m=p.val(),g=userPhone,y=d.val();if(b()!==!0)return!1;var w={provinceCode:e-0,cityCode:t-0,projectName:r,propertyDeveloper:i,contractAmount:o-0,loanAmount:v-0,loanLimit:m-0,phone:g,model:0,loanNo:"2015042001",status:0,partner:y};return $.ajax({url:"/loan/loanApply",type:"post",data:w,dataType:"json",success:function(e){e.code==0?window.location.href="/loan/loanApplySuccess?id="+e.data.id:e.code==1?window.location.href="/loan/loanApplyFailed":s.show(n.errorCode[e.code]||"未知错误["+e.code+"]")}}),!1}),!function(){r.initComplexArea("provinceCode","cityCode","strictCode","33","3301","330106")}(),$("#addParter").on("click",function(){C()});var S=["电梯系统","空调设备","厨房电器"];$(".dialogParter_closebtn").on("click",function(){N()});var k=$("#parterType"),L=$("#company");k.on("click",function(){$(".parterTypeList").toggle()}),$(".parterTypeList a").on("click",function(e){$("#parterType").val(e.target.innerHTML),$(".parterTypeList").hide()}),L.on("change",function(){O(this.value)}),$("#formParter").on("submit",function(){return!A(k.val())||!O(L.val())?!1:($.ajax({type:"post",url:"",data:{type:k.val(),company:L.val()},success:function(e){e.code==0&&N()}}),!1)}),$("#dialogParter_cancel").on("click",function(){N()})});